      program test_scale
c     test sb sclcof1
                  
      real*8 czhar(12),cchar(77),cshar(77),harcofs(77),mdy
      integer*4 n,m

      
      
      czhar(1)= -484.165143790815D-06    + 11.6D-12  *dyr_2000   
      czhar(2)=    0.957161207093473D-06 +  4.9D-12 *dyr_2000
      czhar(3)=    0.539965866638991D-06 +  4.7D-12  *dyr_2000  
      czhar(4)=    0.686702913736681D-07 
      czhar(5)=   -0.149953927978527D-06 
      czhar(6)=    0.905120844521618D-07  
      czhar(7)=    0.494756003005199D-07 
      czhar(8)=    0.280180753216300D-07   
      czhar(9)=    0.533304381729473D-07  
c     czhar(10)=  -0.507683787085927D-07  
c     czhar(11)=   0.364361922614572D-07 


C     Sectorials and Tesserals
          
c        (2,2) 

      cchar(2)=   0.243938357328313D-05  
      cshar(2)=  -0.140027370385934D-05  
  
C        (3,1), (3,2), (3,3)

      cchar(3)=  0.203046201047864D-05  
      cshar(3)=  0.248200415856872D-06  
      cchar(4)=  0.904787894809528D-06  
      cshar(4)= -0.619005475177618D-06  
      cchar(5)=  0.721321757121568D-06  
      cshar(5)=  0.141434926192941D-05  
    
* EGM08
c  3   1  0.203046201047864D-05    0.248200415856872D-06    0.5726633183D-11    0.5976692146D-11
c  3   2  0.904787894809528D-06   -0.619005475177618D-06    0.6374776928D-11    0.6401837794D-11
c  3   3  0.721321757121568D-06    0.141434926192941D-05    0.6029131793D-11    0.6028311182D-11

C        (4,1), (4,2), (4,3), (4,4)
C
      cchar(6)=  -0.536157389388867D-06    
      cshar(6)=  -0.473567346518086D-06    
      cchar(7)=   0.350501623962649D-06    
      cshar(7)=   0.662480026275829D-06    
      cchar(8)=   0.990856766672321D-06    
      cshar(8)=  -0.200928369177E-06 
      cchar(9)=  -0.188560802735E-06
      cshar(9)=   0.308853169333E-06  
     
* EGM08          
c  4    1   -0.536157389388867D-06   -0.473567346518086D-06    0.4568074333D-11    0.4684043490D-11
c  4    2    0.350501623962649D-06    0.662480026275829D-06    0.5307840320D-11    0.5186098530D-11
c  4    3    0.990856766672321D-06   -0.200956723567452D-06    0.5631952953D-11    0.5620296098D-11
c  4    4   -0.188519633023033D-06    0.308803882149194D-06    0.5372877167D-11    0.5383247677D-11


C        (5,1), (5,2), (5,3), (5,4), (5,5)
C
      cchar(10)=  -0.629211923042529D-07
      cshar(10)=  -0.943698073395769D-07
      cchar(11)=   0.652078043176164D-06
      cshar(11)=  -0.323353192540522D-06
      cchar(12)=  -0.451847152328843D-06
      cshar(12)=  -0.214955408306046D-06
      cchar(13)=  -0.295328761175629D-06 
      cshar(13)=   0.498070550102351D-07
      cchar(14)=   0.174811795496002D-06
      cshar(14)=  -0.669379935180165D-06
 
* EGM08
c    5    1   -0.629211923042529D-07   -0.943698073395769D-07    0.2989077566D-11    0.3143313186D-11
c    5    2    0.652078043176164D-06   -0.323353192540522D-06    0.3822796143D-11    0.3642768431D-11
c    5    3   -0.451847152328843D-06   -0.214955408306046D-06    0.4725934077D-11    0.4688985442D-11
c    5    4   -0.295328761175629D-06    0.498070550102351D-07    0.5332198489D-11    0.5302621028D-11
c    5    5    0.174811795496002D-06   -0.669379935180165D-06    0.4980396595D-11    0.4981027282D-11
 

C        (6,1), (6,2), (6,3), (6,4), (6,5), (6,6)
C
      cchar(15)=  -0.759210081892527D-07
      cshar(15)=   0.265122593213647D-07
      cchar(16)=   0.486488924604690D-07 
      cshar(16)=  -0.373789324523752D-06
      cchar(17)=   0.572451611175653D-07
      cshar(17)=   0.895201130010730D-08 
      cchar(18)=  -0.860237937191611D-07 
      cshar(18)=  -0.471425573429095D-06 
      cchar(19)=  -0.267166423703038D-06 
      cshar(19)=  -0.536493151500206D-06 
      cchar(20)=   0.947068749756882D-08 
      cshar(20)=  -0.237382353351005D-06      

* EGM08
c    6    1   -0.759210081892527D-07    0.265122593213647D-07    0.2085980159D-11    0.2193954647D-11
c    6    2    0.486488924604690D-07   -0.373789324523752D-06    0.2603949443D-11    0.2466506184D-11
c    6    3    0.572451611175653D-07    0.895201130010730D-08    0.3380286162D-11    0.3347204566D-11
c    6    4   -0.860237937191611D-07   -0.471425573429095D-06    0.4535102219D-11    0.4489428324D-11
c    6    5   -0.267166423703038D-06   -0.536493151500206D-06    0.5097794605D-11    0.5101153019D-11
c    6    6    0.947068749756882D-08   -0.237382353351005D-06    0.4731651005D-11    0.4728357086D-11
  

C        (7,1), (7,2), (7,3), (7,4), (7,5), (7,6), (7,7)

      cchar(21)=  0.280887555776673D-06
      cshar(21)=  0.951259362869275D-07 
      cchar(22)=  0.330407993702235D-06
      cshar(22)=  0.929969290624092D-07 
      cchar(23)=  0.250458409225729D-06
      cshar(23)= -0.217118287729610D-06
      cchar(24)= -0.274993935591631D-06
      cshar(24)= -0.124058403514343D-06 
      cchar(25)=  0.164773255934658D-08  
      cshar(25)=  0.179281782751438D-07
      cchar(26)= -0.358798423464889D-06
      cshar(26)=  0.151798257443669D-06
      cchar(27)=  0.150746472872675D-08
      cshar(27)=  0.241068767286303D-07 

*EGM08
c    7    1    0.280887555776673D-06    0.951259362869275D-07    0.1561721696D-11    0.1656779220D-11
c    7    2    0.330407993702235D-06    0.929969290624092D-07    0.1917954909D-11    0.1813082652D-11
c    7    3    0.250458409225729D-06   -0.217118287729610D-06    0.2421172504D-11    0.2406891912D-11
c    7    4   -0.274993935591631D-06   -0.124058403514343D-06    0.3384737305D-11    0.3327030779D-11
c    7    5    0.164773255934658D-08    0.179281782751438D-07    0.4372616383D-11    0.4378544108D-11
c    7    6   -0.358798423464889D-06    0.151798257443669D-06    0.5033507782D-11    0.5024794147D-11
c    7    7    0.150746472872675D-08    0.241068767286303D-07    0.4572229702D-11    0.4570746400D-11

C
C        (8,1), (8,2), (8,3), (8,4), (8,5), (8,6), (8,7), (8,8)
C
      cchar(28)=   0.231607991248329D-07 
      cshar(28)=   0.588974540927606D-07
      cchar(29)=   0.800143604736599D-07
      cshar(29)=   0.652805043667369D-07 
      cchar(30)=  -0.193745381715290D-07 
      cshar(30)=  -0.859639339125694D-07
      cchar(31)=  -0.244360480007096D-06
      cshar(31)=   0.698072508472777D-07 
      cchar(32)=  -0.257011477267991D-07
      cshar(32)=   0.892034891745881D-07 
      cchar(33)=  -0.659648680031408D-07
      cshar(33)=   0.308946730783065D-06 
      cchar(34)=   0.672569751771483D-07
      cshar(34)=   0.748686063738231D-07
      cchar(35)=  -0.124022771917136D-06
      cshar(35)=   0.120551889384997D-06
   
*EGM08
c    8    1    0.231607991248329D-07    0.588974540927606D-07    0.1241750465D-11    0.1326654814D-11
c    8    2    0.800143604736599D-07    0.652805043667369D-07    0.1494951534D-11    0.1411005252D-11
c    8    3   -0.193745381715290D-07   -0.859639339125694D-07    0.1864101313D-11    0.1850301061D-11
c    8    4   -0.244360480007096D-06    0.698072508472777D-07    0.2597222975D-11    0.2556744174D-11
c    8    5   -0.257011477267991D-07    0.892034891745881D-07    0.3210497723D-11    0.3217620934D-11
c    8    6   -0.659648680031408D-07    0.308946730783065D-06    0.4312331128D-11    0.4296497239D-11
c    8    7    0.672569751771483D-07    0.748686063738231D-07    0.4982969530D-11    0.4986624872D-11
c    8    8   -0.124022771917136D-06    0.120551889384997D-06    0.4498624439D-11    0.4501340997D-11


C     (9,1), (9,2), (9,3), (9,4), (9,5), (9,6), (9,7), (9.8), (9,9)

      cchar(36)=   0.142151377236084D-06 
      cshar(36)=   0.214004665077510D-07 
      cchar(37)=   0.214144381199757D-07
      cshar(37)=  -0.316984195352417D-07
      cchar(38)=  -0.160612356882835D-06
      cshar(38)=  -0.742658786809216D-07
      cchar(39)=  -0.936529556592536D-08 
      cshar(39)=   0.199026740710063D-07
      cchar(40)=  -0.163134050605937D-07
      cshar(40)=  -0.540394840426217D-07
      cchar(41)=   0.627879491161446D-07 
      cshar(41)=   0.222962377434615D-06
      cchar(42)=  -0.117983924385618D-06
      cshar(42)=  -0.969222126840068D-07
      cchar(43)=   0.188136188986452D-06 
      cshar(43)=  -0.300538974811744D-08
      cchar(44)=  -0.475568433357652D-07
      cshar(44)=   0.968804214389955D-07

       
* EGM08
c    9    1    0.142151377236084D-06    0.214004665077510D-07    0.1018511829D-11    0.1089176581D-11
c    9    2    0.214144381199757D-07   -0.316984195352417D-07    0.1208927719D-11    0.1141907553D-11
c    9    3   -0.160612356882835D-06   -0.742658786809216D-07    0.1470083017D-11    0.1457047050D-11
c    9    4   -0.936529556592536D-08    0.199026740710063D-07    0.2110483299D-11    0.2073741397D-11
c    9    5   -0.163134050605937D-07   -0.540394840426217D-07    0.2551829532D-11    0.2558834844D-11
c    9    6    0.627879491161446D-07    0.222962377434615D-06    0.3185143905D-11    0.3168799261D-11
c    9    7   -0.117983924385618D-06   -0.969222126840068D-07    0.4294900507D-11    0.4301792728D-11
c    9    8    0.188136188986452D-06   -0.300538974811744D-08    0.5026516563D-11    0.5019526183D-11
c    9    9   -0.475568433357652D-07    0.968804214389955D-07    0.4457949868D-11    0.4455360399D-11


C    (10,1), (10,2), (10,3), (10,4), (10,5), (10,6), (10,7), (10.8), (10.9), (10,10)

      cchar(45)=   0.837623112620412D-07   
      cshar(45)=  -0.131092332261065D-06
      cchar(46)=  -0.939894766092874D-07   
      cshar(46)=  -0.512746772537482D-07
      cchar(47)=  -0.700709997317429D-08  
      cshar(47)=  -0.154139929404373D-06
      cchar(48)=  -0.844715388074630D-07
      cshar(48)=  -0.790255527979406D-07
      cchar(49)=  -0.492894049964295D-07 
      cshar(49)=  -0.506137282060864D-07
      cchar(50)=  -0.375849022022301D-07
      cshar(50)=  -0.797688616388143D-07  
      cchar(51)=   0.826209286523474D-08
      cshar(51)=  -0.304903703914366D-08
      cchar(52)=   0.405981624580941D-07
      cshar(52)=  -0.917138622482163D-07
      cchar(53)=   0.125376631604340D-06
      cshar(53)=  -0.379436584841270D-07
      cchar(54)=   0.100435991936118D-06  
      cshar(54)=  -0.238596204211893D-07
               
* EGM08
c   10    1    0.837623112620412D-07   -0.131092332261065D-06    0.8725265082D-12    0.9369288876D-12
c   10    2   -0.939894766092874D-07   -0.512746772537482D-07    0.1020861440D-11    0.9629255322D-12
c   10    3   -0.700709997317429D-08   -0.154139929404373D-06    0.1211784695D-11    0.1201381484D-11
c   10    4   -0.844715388074630D-07   -0.790255527979406D-07    0.1715837141D-11    0.1685872506D-11
c   10    5   -0.492894049964295D-07   -0.506137282060864D-07    0.2138050044D-11    0.2141170996D-11
c   10    6   -0.375849022022301D-07   -0.797688616388143D-07    0.2648268739D-11    0.2635493771D-11
c   10    7    0.826209286523474D-08   -0.304903703914366D-08    0.3161812047D-11    0.3169439904D-11
c   10    8    0.405981624580941D-07   -0.917138622482163D-07    0.4338699172D-11    0.4329214415D-11
c   10    9    0.125376631604340D-06   -0.379436584841270D-07    0.5088298058D-11    0.5089339716D-11
c   10   10    0.100435991936118D-06   -0.238596204211893D-07    0.4485425587D-11    0.4492976952D-11
   
c  (11,1)  (11,2)  (11,3)  (11,4)  (11,5)  (11,6)  (11,7)  (11,8)  (11,9)  (11,10)  (11,11)
      cchar(55)=  0.156127678638183D-07
      cshar(55)= -0.271235374123689D-07
      cchar(56)=  0.201135250154855D-07
      cshar(56)= -0.990003954905590D-07
      cchar(57)= -0.305773531606647D-07
      cshar(57)= -0.148835345047152D-06
      cchar(58)= -0.379499015091407D-07 
      cshar(58)= -0.637669897493018D-07
      cchar(59)=  0.374192407050580D-07 
      cshar(59)=  0.495908160271967D-07
      cchar(60)= -0.156429128694775D-08
      cshar(60)=  0.342735099884706D-07
      cchar(61)=  0.465461661449953D-08
      cshar(61)= -0.898252194924903D-07
      cchar(62)= -0.630174049861897D-08
      cshar(62)=  0.245446551115189D-07
      cchar(63)= -0.310727993686101D-07
      cshar(63)=  0.420682585407293D-07
      cchar(64)= -0.522444922089646D-07
      cshar(64)= -0.184216383163730D-07 
      cchar(65)=  0.462340571475799D-07
      cshar(65)= -0.696711251523700D-07

            
* EGM08
c   11    1    0.156127678638183D-07   -0.271235374123689D-07    0.7452185027D-12    0.8036122515D-12
c   11    2    0.201135250154855D-07   -0.990003954905590D-07    0.8606424948D-12    0.8092076047D-12
c   11    3   -0.305773531606647D-07   -0.148835345047152D-06    0.9938761038D-12    0.9860988538D-12
c   11    4   -0.379499015091407D-07   -0.637669897493018D-07    0.1408298701D-11    0.1384873073D-11
c   11    5    0.374192407050580D-07    0.495908160271967D-07    0.1723064630D-11    0.1724028181D-11
c   11    6   -0.156429128694775D-08    0.342735099884706D-07    0.2239526081D-11    0.2226699156D-11
c   11    7    0.465461661449953D-08   -0.898252194924903D-07    0.2629042863D-11    0.2633757471D-11
c   11    8   -0.630174049861897D-08    0.245446551115189D-07    0.3110698398D-11    0.3104168068D-11
c   11    9   -0.310727993686101D-07    0.420682585407293D-07    0.4301399768D-11    0.4302632213D-11
c   11   10   -0.522444922089646D-07   -0.184216383163730D-07    0.5043723530D-11    0.5047182552D-11
c   11   11    0.462340571475799D-07   -0.696711251523700D-07    0.4435207810D-11    0.4431129672D-11
  
                                                         
c (12,1)  (12,2)  (12,3)) (12,4)  (12,5)) (12,6)  (12,7)  (12,8)  (12,9)  (12,10)  (12,11)  (12,12)
                
      cchar(66)=  -0.535856270449833D-07
      cshar(66)=  -0.431656037232084D-07
      cchar(67)=   0.142665936828290D-07
      cshar(67)=   0.310937162901519D-07
      cchar(68)=   0.396211271409354D-07
      cshar(68)=   0.250622628960907D-07 
      cchar(69)=  -0.677284618097416D-07
      cshar(69)=   0.383823469584472D-08 
      cchar(70)=   0.308775410911475D-07
      cshar(70)=   0.759066416791107D-08
      cchar(71)=   0.313421100991039D-08
      cshar(71)=   0.389801868153392D-07
      cchar(72)=  -0.190517957483100D-07
      cshar(72)=   0.357268620672699D-07
      cchar(73)=  -0.258866871220994D-07
      cshar(73)=   0.169362538600173D-07
      cchar(74)=   0.419147664170774D-07 
      cshar(74)=   0.249625636010847D-07
      cchar(75)=  -0.619955079880774D-08
      cshar(75)=   0.309398171578482D-07
      cchar(76)=   0.113644952089825D-07
      cshar(76)=  -0.638551119140755D-08
      cchar(77)=  -0.242377235648074D-08
      cshar(77)=  -0.110993698692881D-07 

*EGM08                                                           
c   12    1   -0.535856270449833D-07   -0.431656037232084D-07    0.6678206552D-12    0.7229860286D-12
c   12    2    0.142665936828290D-07    0.310937162901519D-07    0.7647850523D-12    0.7182354948D-12
c   12    3    0.396211271409354D-07    0.250622628960907D-07    0.8652130893D-12    0.8587184231D-12
c   12    4   -0.677284618097416D-07    0.383823469584472D-08    0.1200511279D-11    0.1181307883D-11
c   12    5    0.308775410911475D-07    0.759066416791107D-08    0.1493653959D-11    0.1494418734D-11
c   12    6    0.313421100991039D-08    0.389801868153392D-07    0.1899052444D-11    0.1888097600D-11
c   12    7   -0.190517957483100D-07    0.357268620672699D-07    0.2310224916D-11    0.2312853972D-11
c   12    8   -0.258866871220994D-07    0.169362538600173D-07    0.2742630216D-11    0.2738642610D-11
c   12    9    0.419147664170774D-07    0.249625636010847D-07    0.3179724783D-11    0.3179019714D-11
c   12   10   -0.619955079880774D-08    0.309398171578482D-07    0.4406917668D-11    0.4416716422D-11
c   12   11    0.113644952089825D-07   -0.638551119140755D-08    0.5202764066D-11    0.5203387539D-11
c   12   12   -0.242377235648074D-08   -0.110993698692881D-07    0.4492820470D-11    0.4493344430D-11

      n=4
      m=4                
10    format(i3,3x,0pd12.4)
      nm = n*(n-1)/2 + m - 1 
      write(*,'(a)')  'Normalized zonals'
      do i=1,n       
        harcofs(i) = czhar(i)
        write(*,10) i,harcofs(i)
      enddo          
      call sclcof1(-1,0,n,m,harcofs) 
      write(*,'(a)') 'Unnormalized zonals'
      do i=1,n
        write(*,10) i,harcofs(i)
      enddo
      write(*,'(a)') 'Re-normalized zonals'
      call sclcof1(1,0,n,m,harcofs)
      do i=1,n
        write(*,10) i,harcofs(i)
      enddo
  
      write(*,'(a)') 'Normalized cosine tesserals'
      do i=1,nm
        harcofs(i) = cchar(i)
        write(*,10) i,harcofs(i)
      enddo
      call sclcof1(-1,1,n,m,harcofs)
      write(*,'(a)') 'Unnormalized cosine tesserals'
      do i=1,nm
        write(*,10) i,harcofs(i)
      enddo
      call sclcof1(1,1,n,m,harcofs)
      write(*,'(a)') 'Re-normalized cosine tesserals'
      do i=1,nm
        write(*,10) i,harcofs(i)
      enddo
  
      stop
      end
      

                                                                            



c-------------------------------------------------------------------------------------
Copyright (c) Massachusetts Institute of Technology, 1986/2017. All rights reserved.
      Subroutine SCLCOF1( dir,ztflag,n,m,harcofs ) 
                                          
c     Scale or unscale zonal or tesseral hamronic coefficients for
c     Legendre functions for nomalization to 4pi and assuming the
c     zonal sign convention of C20 (not J2).   This is a modification
c     of subroutine SCLCOF but now accepts the hamronic coefficients
c     as input arguments so that it can be applied to tidal perturbations
c     as well as the static geopotential.  

c     Note: Dimensions currently hard-wired to 12th degreeand order

c     R. King March 10, 2017

c     Input
c       dir  : -1  unscale 
c            :  1  scale 
c       ztflag: 0  harmonics are for zonals
c               1  harmonics are for tesserals
c       n    : degree 
c       m    : order
c      Input and output
c         harcofs(77) : coefficients to degree and order 12 

      implicit none

c**      include '../includes/dimpar.h'   
c**      include '../includes/arc.h'

                              
      integer*4 dir,ztflag,n,m,ff,ih,jh,i,j,mm
      real*8 sclcf,harcofs(77),f
             
      print *,'dir ztflag n  m ',dir,ztflag,n,m
                                          
      if( ztflag.eq.0 ) then
c       scale the zonals
        do i=2,n            
          sclcf = dsqrt(dble(2*i+1))           
cd          print *,'i-1 sclcf ',i-1,sclcf
          if( dir.eq.-1 ) harcofs(i-1) = harcofs(i-1) * sclcf
          if( dir.eq. 1)  harcofs(i-1) = harcofs(i-1) / sclcf 
        enddo   
                    
      elseif ( ztflag.eq.1 ) then
c       scale the tesserals 
        jh = 0 
        do i=2,n
          do ih=1,i
            jh=jh+1
            ff = i - ih
            f = ff + 1
            mm = 2 * ih
cd            print *,'i jh ff mm ',i,jh,ff,mm
            do j=2,mm         
              f = f * dble(ff+j)                        
cd              print *,'f ',f
            enddo
            sclcf = dsqrt(dble(4*i+2)/f)
cd            print *,'i sclcf ',i,sclcf
            if( dir.eq.-1 ) harcofs(jh) = harcofs(jh)*sclcf
            if( dir.eq. 1 ) harcofs(jh) = harcofs(jh)/sclcf
          enddo
        enddo
      endif

      return
      end



