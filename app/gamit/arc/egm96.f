Copyright (c) Massachusetts Institute of Technology and University of
California at San Diega, 1986-1994. All rights reserved.

      Subroutine EGM96

c     Initialize constants according to IERS-2000 conventions
c     T. Herring 2003.

      implicit none    

      include '../includes/dimpar.h'   
      include '../includes/arc.h'


* LOCAL VARIABLES
      real*8 dyr_2000  ! Years since J2000 ref for gravity coefficients
      integer*4 i
                              
      do i=1,11
        czhar(i)=0.d0
      enddo
      do i=1,77
        cchar(i)=0.d0
        cshar(i)=0.d0
      enddo

c        IERS Standards for Constants - coded from NOAA iers.f and
c        then correct GM from .4418 to .4415 for consistency with other
c        IGS centers. Ray/King 950920

      ltvel= 299792.458D0
      aunit= 1.4959787061D8
      ertrad= 6378.1363D0 
      monrad = 1738.d0
      sunrad= 696000.D+00
C               GM OF THE EARTH
      gm(1)= 398600.4415D+0
cold  gm(1)= 398600.4418D+0
C               GM OF THE MOON
      gm(2)= 4902.7989D+0
C               GM OF THE SUN
      gm(3)= 1.32712440D+11
C
      crad= ertrad

c-------------------------------------------------------------------------
c         ** former MIT code - effectively equivalent
c         LTVEL=299792.458D0
c         AULTSC=499.00478370D0
c         ERTRAD=6378.137D0
c         SUNRAD=6.96D+05
c         CONST=(0.01720209895D0)**2*(LTVEL)**3*(AULTSC)**3/(86400.D0)**2
c               GM OF THE EARTH
c         Value used until 9103012: SEM = 328900.553  => GM = 398600.4445
c              (Proper MERIT value: SEM = 328900.5501 << GM = 398600.448)
c         New value from CSR8901  : SEM = 328900.5564 << GM = 398600.4401
c         IERS/IGS 1992 stds value: SEM = 328900.5552 << GM = 398600.4418
c         GM(1)= CONST*81.3005883D0/(1.D0+81.3005883D0)*1.D0/328900.55523496d0
c               GM OF THE MOON
c         GM(2) = GM(1)/81.3005883D0
c               GM OF THE SUN
c         GM(3) = (GM(1)+GM(2))*328900.55523496d0
c----------------------------------------------------------------------------

      crad = ertrad
   

****  Compute time in years since J2000    
*     use start time rather than IC epoch since g-file not yet read
c      dyr_2000 = (jde - 2451544.d0)/365.25d0                       
      dyr_2000 = (jdb - 2451544.d0)/365.25d0      

C     Zonals  J2,J3,J4,J5,J6,J7,J8
C
      czhar(1)= -484.1652094D-06     + 1.162755d-11*dyr_2000 
      czhar(2)=    0.957254173792E-06
      czhar(3)=    0.539873863789E-06
      czhar(4)=    0.685323475630E-07
      czhar(5)=   -0.149957994714E-06
      czhar(6)=    0.909789371450E-07
      czhar(7)=    0.496711667324E-07
      czhar(8)=    0.276714300853E-07
      czhar(9)=    0.526222488569E-07
      czhar(10)=  -0.509613707522E-07
    
* Zonals from EGM96 (Note: C20 changed to match IERS 2000)
C   2   0 -0.484165371736E-03  0.000000000000E+00  0.35610635E-10  0.00000000E+00
C   3   0  0.957254173792E-06  0.000000000000E+00  0.18094237E-10  0.00000000E+00
C   4   0  0.539873863789E-06  0.000000000000E+00  0.10423678E-09  0.00000000E+00
C   5   0  0.685323475630E-07  0.000000000000E+00  0.54383090E-10  0.00000000E+00
C   6   0 -0.149957994714E-06  0.000000000000E+00  0.14497863E-09  0.00000000E+00
C   7   0  0.909789371450E-07  0.000000000000E+00  0.13919821E-09  0.00000000E+00
C   8   0  0.496711667324E-07  0.000000000000E+00  0.22663861E-09  0.00000000E+00
C   9   0  0.276714300853E-07  0.000000000000E+00  0.22214648E-09  0.00000000E+00
C  10   0  0.526222488569E-07  0.000000000000E+00  0.30890035E-09  0.00000000E+00
C  11   0 -0.509613707522E-07  0.000000000000E+00  0.34552145E-09  0.00000000E+00
C  12   0  0.377252636558E-07  0.000000000000E+00  0.43588608E-09  0.00000000E+00
C  13   0  0.422982206413E-07  0.000000000000E+00  0.48735174E-09  0.00000000E+00
          
C     Sectorials and Tesserals

C     (2,1), (2,2)

      cchar(1)=  -2.23d-10   - 0.337d-11*dyr_2000
      cshar(1)=  14.48d-10   + 1.606d-11*dyr_2000
      cchar(2)=   0.243914352398E-05
      cshar(2)=  -0.140016683654E-05

C***  Print the values of the coefficients being used
      write(iarh,120) dyr_2000, czhar(1)*1.d9, cchar(1)*1.d9
     .              , cshar(1)*1.d9
 120  format(' EGM96: ',f5.1,' yrs from J2000, C20 ',F12.4,'D-9, C21 ',
     .       F8.4,'D-9, S21 ',F8.4,'D-9',/)
* 2nd degree EGM96
C  2   1 -0.186987635955E-09  0.119528012031E-08  0.10000000E-29  0.10000000E-29
C  2   2  0.243914352398E-05 -0.140016683654E-05  0.53739154E-10  0.54353269E-10

C        (3,1), (3,2), (3,3)

      cchar(3)=  0.202998882184E-05 
      cshar(3)=  0.248513158716E-06 
      cchar(4)=  0.904627768605E-06
      cshar(4)= -0.619025944205E-06
      cchar(5)=  0.721072657057E-06
      cshar(5)=  0.141435626958E-05

C  3   1  0.202998882184E-05  0.248513158716E-06  0.13965165E-09  0.13645882E-09
C  3   2  0.904627768605E-06 -0.619025944205E-06  0.10962329E-09  0.11182866E-09
C  3   3  0.721072657057E-06  0.141435626958E-05  0.95156281E-10  0.93285090E-10

C        (4,1), (4,2), (4,3), (4,4)
C
      cchar(6)=  -0.536321616971E-06
      cshar(6)=  -0.473440265853E-06
      cchar(7)=   0.350694105785E-06
      cshar(7)=   0.662671572540E-06
      cchar(8)=   0.990771803829E-06
      cshar(8)=  -0.200928369177E-06
      cchar(9)=  -0.188560802735E-06
      cshar(9)=   0.308853169333E-06
C  4   1 -0.536321616971E-06 -0.473440265853E-06  0.85674404E-10  0.82408489E-10
C  4   2  0.350694105785E-06  0.662671572540E-06  0.16000186E-09  0.16390576E-09
C  4   3  0.990771803829E-06 -0.200928369177E-06  0.84657802E-10  0.82662506E-10
C  4   4 -0.188560802735E-06  0.308853169333E-06  0.87315359E-10  0.87852819E-10


C
C        (5,1), (5,2), (5,3), (5,4), (5,5)
C
      cchar(10)= -0.621012128528E-07 
      cshar(10)= -0.944226127525E-07
      cchar(11)=  0.652438297612E-06
      cshar(11)= -0.323349612668E-06
      cchar(12)= -0.451955406071E-06
      cshar(12)= -0.214847190624E-06 
      cchar(13)= -0.295301647654E-06
      cshar(13)=  0.496658876769E-07
      cchar(14)=  0.174971983203E-06
      cshar(14)= -0.669384278219E-06

C  5   1 -0.621012128528E-07 -0.944226127525E-07  0.27996887E-09  0.28082882E-09
C  5   2  0.652438297612E-06 -0.323349612668E-06  0.23747375E-09  0.24356998E-09
C  5   3 -0.451955406071E-06 -0.214847190624E-06  0.17111636E-09  0.16810647E-09
C  5   4 -0.295301647654E-06  0.496658876769E-07  0.11981266E-09  0.11849793E-09
C  5   5  0.174971983203E-06 -0.669384278219E-06  0.11642563E-09  0.11590031E-09
C
C        (6,1), (6,2), (6,3), (6,4), (6,5), (6,6)
C
      cchar(15)=  -0.760879384947E-07
      cshar(15)=   0.262890545501E-07 
      cchar(16)=   0.481732442832E-07
      cshar(16)=  -0.373728201347E-06
      cchar(17)=   0.571730990516E-07
      cshar(17)=   0.902694517163E-08
      cchar(18)=  -0.862142660109E-07
      cshar(18)=  -0.471408154267E-06
      cchar(19)=  -0.267133325490E-06
      cshar(19)=  -0.536488432483E-06
      cchar(20)=   0.967616121092E-08
      cshar(20)=  -0.237192006935E-06
c  6   1 -0.760879384947E-07  0.262890545501E-07  0.22415138E-09  0.21957296E-09
c  6   2  0.481732442832E-07 -0.373728201347E-06  0.27697363E-09  0.28105811E-09
c  6   3  0.571730990516E-07  0.902694517163E-08  0.19432407E-09  0.18682712E-09
c  6   4 -0.862142660109E-07 -0.471408154267E-06  0.15229150E-09  0.15328004E-09
c  6   5 -0.267133325490E-06 -0.536488432483E-06  0.89838470E-10  0.87820905E-10
c  6   6  0.967616121092E-08 -0.237192006935E-06  0.11332010E-09  0.11518036E-09
C
C        (7,1), (7,2), (7,3), (7,4), (7,5), (7,6), (7,7)
C
      cchar(21)=  0.279872910488E-06
      cshar(21)=  0.954336911867E-07
      cchar(22)=  0.329743816488E-06
      cshar(22)=  0.930667596042E-07
      cchar(23)=  0.250398657706E-06
      cshar(23)= -0.217198608738E-06
      cchar(24)= -0.275114355257E-06
      cshar(24)= -0.123800392323E-06
      cchar(25)=  0.193765507243E-08
      cshar(25)=  0.177377719872E-07
      cchar(26)= -0.358856860645E-06
      cshar(26)=  0.151789817739E-06
      cchar(27)=  0.109185148045E-08
      cshar(27)=  0.244415707993E-07

C  7   1  0.279872910488E-06  0.954336911867E-07  0.43500231E-09  0.42584820E-09
C  7   2  0.329743816488E-06  0.930667596042E-07  0.39034671E-09  0.39858085E-09
C  7   3  0.250398657706E-06 -0.217198608738E-06  0.32646930E-09  0.31799577E-09
C  7   4 -0.275114355257E-06 -0.123800392323E-06  0.23251698E-09  0.22964717E-09
C  7   5  0.193765507243E-08  0.177377719872E-07  0.16792139E-09  0.17201828E-09
C  7   6 -0.358856860645E-06  0.151789817739E-06  0.89799183E-10  0.89575785E-10
C  7   7  0.109185148045E-08  0.244415707993E-07  0.13599934E-09  0.13564720E-09
C
C        (8,1), (8,2), (8,3), (8,4), (8,5), (8,6), (8,7), (8,8)
C
      cchar(28)=  0.233422047893E-07
      cshar(28)=  0.590060493411E-07
      cchar(29)=  0.802978722615E-07
      cshar(29)=  0.654175425859E-07
      cchar(30)= -0.191877757009E-07
      cshar(30)= -0.863454445021E-07
      cchar(31)= -0.244600105471E-06
      cshar(31)=  0.700233016934E-07
      cchar(32)= -0.255352403037E-07
      cshar(32)=  0.891462164788E-07   
      cchar(33)= -0.657361610961E-07
      cshar(33)=  0.309238461807E-06
      cchar(34)=  0.672811580072E-07
      cshar(34)=  0.747440473633E-07
      cchar(35)= -0.124092493016E-06
      cshar(35)=  0.120533165603E-06

C  8   1  0.233422047893E-07  0.590060493411E-07  0.40634230E-09  0.39490843E-09
C  8   2  0.802978722615E-07  0.654175425859E-07  0.36512930E-09  0.36825158E-09
C  8   3 -0.191877757009E-07 -0.863454445021E-07  0.29352566E-09  0.28069012E-09
C  8   4 -0.244600105471E-06  0.700233016934E-07  0.25244455E-09  0.26262799E-09
C  8   5 -0.255352403037E-07  0.891462164788E-07  0.20021311E-09  0.19479275E-09
C  8   6 -0.657361610961E-07  0.309238461807E-06  0.16673572E-09  0.16680807E-09
C  8   7  0.672811580072E-07  0.747440473633E-07  0.94505589E-10  0.95246237E-10
C  8   8 -0.124092493016E-06  0.120533165603E-06  0.15695393E-09  0.15769999E-09

C     (9,1), (9,2), (9,3), (9,4), (9,5), (9,6), (9,7), (9.8), (9,9)

      cchar(36)=   0.143387502749E-06
      cshar(36)=   0.216834947618E-07
      cchar(37)=   0.222288318564E-07
      cshar(37)=  -0.322196647116E-07
      cchar(38)=  -0.160811502143E-06
      cshar(38)=  -0.742287409462E-07
      cchar(39)=  -0.900179225336E-08
      cshar(39)=   0.194666779475E-07
      cchar(40)=  -0.166165092924E-07
      cshar(40)=  -0.541113191483E-07
      cchar(41)=   0.626941938248E-07
      cshar(41)=   0.222903525945E-06
      cchar(42)=  -0.118366323475E-06
      cshar(42)=  -0.965152667886E-07
      cchar(43)=   0.188436022794E-06
      cshar(43)=  -0.308566220421E-08
      cchar(44)=  -0.477475386132E-07
      cshar(44)=   0.966412847714E-07
C  9   1  0.143387502749E-06  0.216834947618E-07  0.58335018E-09  0.55609313E-09
C  9   2  0.222288318564E-07 -0.322196647116E-07  0.48353378E-09  0.48392082E-09
C  9   3 -0.160811502143E-06 -0.742287409462E-07  0.46594220E-09  0.45810990E-09
C  9   4 -0.900179225336E-08  0.194666779475E-07  0.36909229E-09  0.36635390E-09
C  9   5 -0.166165092924E-07 -0.541113191483E-07  0.29221604E-09  0.30036229E-09
C  9   6  0.626941938248E-07  0.222903525945E-06  0.22052623E-09  0.22142953E-09
C  9   7 -0.118366323475E-06 -0.965152667886E-07  0.18155999E-09  0.18063564E-09
C  9   8  0.188436022794E-06 -0.308566220421E-08  0.13135894E-09  0.13157891E-09
C  9   9 -0.477475386132E-07  0.966412847714E-07  0.18551471E-09  0.18432444E-09

C    (10,1), (10,2), (10,3), (10,4), (10,5), (10,6), (10,7), (10.8), (10.9), (10,10)

      cchar(45)=  0.835115775652E-07
      cshar(45)= -0.131314331796E-06
      cchar(46)= -0.942413882081E-07
      cshar(46)= -0.515791657390E-07
      cchar(47)= -0.689895048176E-08
      cshar(47)= -0.153768828694E-06
      cchar(48)= -0.840764549716E-07
      cshar(48)= -0.792806255331E-07
      cchar(49)= -0.493395938185E-07
      cshar(49)= -0.505370221897E-07
      cchar(50)= -0.375885236598E-07
      cshar(50)= -0.795667053872E-07
      cchar(51)=  0.811460540925E-08
      cshar(51)= -0.336629641314E-08
      cchar(52)=  0.404927981694E-07
      cshar(52)= -0.918705975922E-07
      cchar(53)=  0.125491334939E-06
      cshar(53)= -0.376516222392E-07
      cchar(54)=  0.100538634409E-06
      cshar(54)= -0.240148449520E-07

C 10   1  0.835115775652E-07 -0.131314331796E-06  0.52560148E-09  0.50053305E-09
C 10   2 -0.942413882081E-07 -0.515791657390E-07  0.44292785E-09  0.44624108E-09
C 10   3 -0.689895048176E-08 -0.153768828694E-06  0.37051454E-09  0.36174988E-09
C 10   4 -0.840764549716E-07 -0.792806255331E-07  0.31088626E-09  0.32213352E-09
C 10   5 -0.493395938185E-07 -0.505370221897E-07  0.32221821E-09  0.32202850E-09
C 10   6 -0.375885236598E-07 -0.795667053872E-07  0.28294160E-09  0.27566976E-09
C 10   7  0.811460540925E-08 -0.336629641314E-08  0.18704768E-09  0.18901334E-09
C 10   8  0.404927981694E-07 -0.918705975922E-07  0.18275291E-09  0.18362644E-09
C 10   9  0.125491334939E-06 -0.376516222392E-07  0.90465977E-10  0.90959794E-10
C 10  10  0.100538634409E-06 -0.240148449520E-07  0.15964045E-09  0.15956547E-09
                                                          
cd      print *,'end of EGM96 cchar(1-2) ',cchar(1),cchar(2)
      return
      end






























